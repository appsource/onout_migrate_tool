(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(n,e,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return t(5995)}])},5995:function(n,e,t){"use strict";t.r(e),t.d(e,{default:function(){return y}});var i=t(5893),s=t(214),r=t.n(s),a=t(7294),c=t(7568),o=t(7582),l=t(8967),u=function(n){var e=(0,a.useState)(!1),t=e[0],i=e[1],s=(0,a.useState)(!1),r=s[0],u=s[1],d=(0,a.useState)(!1),h=d[0],f=d[1],m=(0,a.useState)(!1),x=m[0],j=m[1],g=(0,a.useState)(!1),v=g[0],p=g[1],w=function(){var e=(0,c.Z)((function(){return(0,o.__generator)(this,(function(e){switch(e.label){case 0:return r&&"".concat(h)=="".concat(n)?(r.eth.getAccounts().then((function(n){j(n[0]||!1)})).catch((function(n){console.log(">>> initOnWeb3Ready",n)})),[3,3]):[3,1];case 1:return[4,(0,l.IC)()];case 2:e.sent()?N():j(!1),e.label=3;case 3:return[2]}}))}));return function(){return e.apply(this,arguments)}}();(0,a.useEffect)((function(){w()}),[r]);var b=function(){var n=(0,c.Z)((function(){return(0,o.__generator)(this,(function(n){return w(),[2]}))}));return function(){return n.apply(this,arguments)}}();(0,a.useEffect)((function(){(0,l.Wk)(b),(0,l.uK)((function(n){w()}))}),[]);var N=function(){var e=(0,c.Z)((function(){return(0,o.__generator)(this,(function(e){return(0,l.pE)({onBeforeConnect:function(){i(!0)},onSetActiveChain:f,onConnected:function(){var e=(0,c.Z)((function(e,t){return(0,o.__generator)(this,(function(s){switch(s.label){case 0:return i(!1),u("".concat(e)=="".concat(n)&&t),t?[3,2]:[4,(0,l.cg)()];case 1:j.apply(void 0,[s.sent()]),s.label=2;case 2:return[2]}}))}));return function(n,t){return e.apply(this,arguments)}}(),onError:function(n){i(!1)}}),[2]}))}));return function(){return e.apply(this,arguments)}}();return{isWalletConnecting:t,isConnected:function(){return!1!==x},isSwitchChain:v,address:x,activeChainId:h,activeWeb3:r,connectWeb3:N,switchChainId:function(e){p(!0),(0,l.M5)(e||n).then((function(n){p(!1)}))}}},d=t(7326),h=t(4360),f=t(797),m=t(794),x=function(){var n=(0,c.Z)((function(n,e,t,i,s){var r,a,c,l;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return a={from:n,gas:"0"},s&&(a.value=new m.O(s)),[4,(r=e.methods)[t].apply(r,(0,f.Z)(i)).estimateGas(a)];case 1:return c=o.sent(),l=new m.O(new m.O(c).multipliedBy(1.15).toFixed(0)).toString(16),a.gas="0x"+l,[2,a]}}))}));return function(e,t,i,s,r){return n.apply(this,arguments)}}(),j=function(n){return new Promise((function(e,t){var i=n.activeWeb3,s=n.contract,r=n.method,a=n.args,l=n.weiAmount,u=n.onTrx||function(){},d=n.onSuccess||function(){},h=n.onError||function(){},m=n.onFinally||function(){};i.eth.getAccounts().then(function(){var n=(0,c.Z)((function(n){var c,j,g,v,p;return(0,o.__generator)(this,(function(o){switch(o.label){case 0:return n.length>0?(j=n[0],console.log(">> amount",l),[4,x(j,s,r,a||[],l)]):[3,3];case 1:return g=o.sent(),[4,i.eth.getGasPrice()];case 2:return v=o.sent(),g.gasPrice=v,console.log(">> amount 2",l,g),(c=s.methods)[r].apply(c,(0,f.Z)(a||[])).send(g).on("transactionHash",(function(n){console.log("transaction hash:",n),p=n,u(n)})).on("error",(function(n){console.log("transaction error:",n),h(n),t(n)})).on("receipt",(function(n){console.log("transaction receipt:",n),d(n)})).then((function(n){e(n),m(n)})).catch((function(n){if(n.message.includes("not mined within 50 blocks"))var s=setInterval((function(){i.eth.getTransactionReceipt(p).then((function(n){null!=n&&n.blockNumber>0&&(clearInterval(s),e(n),d(n))}))}),1e3);else h(n),t(n)})),[3,4];case 3:t("NO_ACTIVE_ACCOUNT"),o.label=4;case 4:return[2]}}))}));return function(e){return n.apply(this,arguments)}}()).catch((function(n){console.log(">>> callContractMethod",n),t(n)}))}))},g=t(3852),v=(t(5888),t(1987)),p=t.n(v),w=/^0x[A-Fa-f0-9]{40}$/,b=function(n){return"string"===typeof n&&w.test(n)},N=t(4262),C={owner:"Migrate ownership"},y=(function(){var n=Object.keys(N.w5).map((function(n){return{id:N.w5[n].networkVersion,title:N.w5[n].chainName}}));n.unshift({id:0,title:"Select Blockchain"})}(),function(n){var e=(0,d.n)(),t=e.storageChainId,s=e.storageAddress,c=n.openConfirmWindow,o=n.addNotify,l=u(t),f=l.isWalletConnecting,m=(l.isConnected,l.isSwitchChain),x=l.address,v=l.activeChainId,w=l.activeWeb3,y=l.connectWeb3,_=l.switchChainId,S=(0,a.useState)(!1),k=S[0],F=S[1];(0,a.useEffect)((function(){if(w&&t&&s){var n=new w.eth.Contract(h.Mt,s);F(n)}}),[w,t,s]);var I=(0,a.useState)("owner"),E=I[0],O=I[1],T=function(n){var e=p().parse(n);return e.hostname||e.pathname},B=(0,a.useState)(""),W=B[0],M=B[1],A=(0,a.useState)(""),R=A[0],Z=A[1],D=(0,a.useState)(""),P=D[0],J=D[1],U=(0,a.useState)(!1),G=U[0],K=U[1],V=(0,a.useState)(!1),X=V[0],Y=V[1],H=(0,a.useState)(!1),L=H[0],$=H[1],q=function(){Y(!1),K(!0);var n=T(W);k.methods.getData(n).call().then((function(n){console.log(">>> JSON",n),Z(n.owner);try{var e=JSON.parse(n.info);console.log(">>> JSON",e),$(e)}catch(t){$({})}Y(!0),K(!1)})).catch((function(n){K(!1),o("Fail fetch domain info. ".concat(n.message),"error")}))},z=(0,a.useState)(!1),Q=z[0],nn=z[1],en=function(){M(""),Z(""),Y(""),$("")};return(0,i.jsxs)("div",{className:r().container,children:[(0,i.jsx)("h1",{className:r().h1,children:"Onout migrate tools"}),x&&"".concat(v)=="".concat(t)?(0,i.jsxs)(i.Fragment,{children:[function(){var n=(0,N.T_)(v),e=(0,N.T_)(t);return(0,i.jsxs)("div",{className:r().adminActiveChainInfo,children:[(0,i.jsxs)("span",{children:["Current active network is ",(0,i.jsxs)("b",{children:[(null===n||void 0===n?void 0:n.chainName)||"Unknown"," (",v,")"]})]}),(0,i.jsxs)("span",{children:["Main config storage network is ",(0,i.jsxs)("b",{children:[(null===e||void 0===e?void 0:e.chainName)||"Unknown"," (",t,")"]})]})]})}(),(0,i.jsx)("div",{className:r().adminForm,children:(0,i.jsxs)("div",{className:r().adminInfo,children:[(0,i.jsx)("span",{children:"Connected wallet"}),(0,i.jsx)("span",{children:(0,i.jsx)("strong",{children:x})})]})}),(0,i.jsx)("ul",{className:r().settingsTabsNav,children:Object.keys(C).map((function(n){return(0,i.jsx)("li",{onClick:function(){O(n)},className:n===E?r().activeTab:"",children:C[n]},n)}))}),(0,i.jsx)("hr",{className:"".concat(r().divider," ").concat(r().spacerTop)}),"domain"==E&&(0,i.jsx)(i.Fragment,{children:"Domain"}),"owner"==E&&(0,i.jsx)(i.Fragment,{children:(0,i.jsx)("div",{className:r().adminForm,children:(0,i.jsxs)("div",{className:r().subFormInfo,children:[(0,i.jsx)("h3",{children:"Migrate ownership of domain"}),!X&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:r().infoRow,children:[(0,i.jsx)("label",{children:"Domain:"}),(0,i.jsx)("div",{children:(0,i.jsx)("input",{type:"text",value:W,onChange:function(n){M(n.target.value)}})})]}),(0,i.jsx)("div",{className:r().actionsRow,children:(0,i.jsx)("button",{disabled:G,onClick:q,className:r().adminButton,children:G?"Fetching domain info...":"Fetch domain info"})})]}),X&&(0,i.jsx)(i.Fragment,{children:R==N.r_?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("hr",{}),(0,i.jsx)("div",{className:r().adminInfo,children:(0,i.jsx)("span",{children:(0,i.jsx)("strong",{children:T(W)})})}),(0,i.jsx)("div",{className:r().adminInfoError,children:(0,i.jsx)("span",{children:"This domain is not configured. Migration not aviable"})}),(0,i.jsx)("hr",{}),(0,i.jsx)("div",{className:r().actionsRow,children:(0,i.jsx)("button",{className:r().adminButton,onClick:en,children:"Try other domain"})})]}):(0,i.jsx)(i.Fragment,{children:R!==x?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("hr",{}),(0,i.jsx)("div",{className:r().adminInfo,children:(0,i.jsx)("span",{children:(0,i.jsx)("strong",{children:T(W)})})}),(0,i.jsxs)("div",{className:r().adminInfoError,children:[(0,i.jsxs)("span",{children:["You are not ownership of ",T(W)]}),(0,i.jsxs)("span",{children:["This domain ownership is: ",R]})]}),(0,i.jsx)("hr",{}),(0,i.jsx)("div",{className:r().actionsRow,children:(0,i.jsx)("button",{className:r().adminButton,onClick:en,children:"Try other domain"})})]}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("hr",{}),(0,i.jsx)("div",{className:r().adminInfo,children:(0,i.jsx)("span",{children:(0,i.jsx)("strong",{children:T(W)})})}),(0,i.jsxs)("div",{className:r().adminInfoError,children:[(0,i.jsxs)("span",{children:["Migrate owner ship for ",T(W)]}),(0,i.jsx)("span",{children:"Be carefull"}),(0,i.jsx)("span",{children:"if you specify a wallet that you do not have access to, you will lose access to the domain"}),(0,i.jsx)("span",{children:"Migration is available ONLY for the domain owner"}),(0,i.jsx)("span",{children:"If you lose access to your wallet, we will not be able to help you!"})]}),(0,i.jsx)("hr",{}),(0,i.jsxs)("div",{className:r().infoRow,children:[(0,i.jsx)("label",{children:"New ownership:"}),(0,i.jsx)("div",{children:(0,i.jsx)("input",{type:"text",value:P,onChange:function(n){J(n.target.value)}})})]}),(0,i.jsxs)("div",{className:r().actionsRow,children:[(0,i.jsx)("button",{className:r().adminButton,onClick:function(){b(P)?c({title:"Migrate ownership",message:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{children:["Do you realy want migrate owner for domain",(0,i.jsx)("br",{}),(0,i.jsx)("strong",{children:T(W)}),(0,i.jsx)("br",{})," from ",(0,i.jsx)("br",{}),(0,i.jsx)("strong",{children:R}),(0,i.jsx)("br",{})," to ",(0,i.jsx)("br",{}),(0,i.jsx)("strong",{children:P}),(0,i.jsx)("br",{}),"???"]}),(0,i.jsx)("div",{})]}),onConfirm:function(){nn(!0),j({activeWeb3:w,contract:k,method:"setKeyData",args:[T(W),{owner:P,info:JSON.stringify(L)}],onTrx:function(n){o("txId ".concat(n),"success")},onSuccess:function(){o("Ownership migrated","success"),nn(!1),q()},onError:function(n){o("Fail migrate ownership ".concat(n.message),"error"),nn(!1)}})}}):c({title:"Error",message:"Specifiy correct address of new ownership",isOk:!0,onConfirm:function(){}})},disabled:Q,children:"Migrate ownership"}),(0,i.jsx)("button",{className:r().adminButton,onClick:en,disabled:Q,children:"Cancel"})]}),(0,i.jsx)("div",{className:r().adminInfoWarning,children:(0,i.jsx)("span",{children:"Current domain settings"})}),(0,i.jsx)("hr",{}),(0,i.jsx)("div",{children:(0,i.jsx)(g.gc,{data:L,shouldExpandNode:g.il,style:g._l})}),(0,i.jsx)("hr",{})]})})})]})})})]}):(0,i.jsx)(i.Fragment,{children:"".concat(v)!="".concat(t)&&v?(0,i.jsx)("button",{disabled:m,className:"".concat(r().mainButton," primaryButton"),onClick:function(){_()},children:m?"Switching network":"Switch network"}):(0,i.jsx)("button",{disabled:f,className:"".concat(r().mainButton," primaryButton"),onClick:y,children:f?"Connecting":"Connect Wallet"})})]})})}},function(n){n.O(0,[789,774,888,179],(function(){return e=8312,n(n.s=e);var e}));var e=n.O();_N_E=e}]);